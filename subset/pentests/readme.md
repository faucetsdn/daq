# Penetration testing

## test_brute

This is a demonstration test that is provided for educational purposes and not
built by default.

The commands included in the tests are the following:

```
python brute_client.py <ip_address> <port> <report_filename>
python brute_server.py <ip_address> <port> <simultaneous_clients>
```

Tests included in this module:

-   security.brute

## test_discover

The discover test module attempts to find information from devices
automatically. It is composed of the BACnet firmware test.

Tests included in this module:

- security.discover.firmware

### Conditions for security.discover.firmware:

- pass -> version matches device_info.firmware_version
- fail -> version DOES NOT match device_info.firmware_version
- info -> version found from device but none defined in device_info.firmware_version
- skip -> cannot get firmware version from device, ports may be filtered

## test_nmap

The nmap module can be uses the nmap tool to check open ports in relation to the
policy that is set in the `site_config.json` file or files and checks the entire
port range for any disallowed services running

It also checks that there isn't any (plain text) HTTP server running on any open
port

Tests included in this module:

- security.nmap.ports
- security.nmap.http
- security.services.smtp
- security.services.pop
- security.services.imap
- security.services.ftp
- security.services.telnet
- security.services.tftp
- security.services.snmp

### Configuration for security.nmap.ports
The module can be configured with two optional parameters in `site_config.json`
```
 "nmap": {
      "test_http": true/false
      "services_scan": true/false
    },
```
- `test_http`: defaults to `true` - run the services.nmap.http scan to find HTTP
  servers running on any port
- `services_scan`: defaults to  `true` - run the full port scan with service
  detection. If true, the legacy NMAP test is used which only scans ports
  predefined in the `servers` block in the `site_config`. May be more useful in
  ATA where time/network resources are restricted

### Conditions for security.nmap.ports

- pass -> all the ports configured in module_config.json agree with the allow/deny policy
- fail -> one or more of the ports configured in module_config.json do not agree
  with the allow/deny policy

### Conditions for security.nmap.http

- pass -> there is no HTTP server running on any of the open ports
- fail -> one or more of the ports is running an HTTP server

### Conditions for security.services.X

- pass -> Service X was not found running and the default port(s) for service X
  were not open
- fail -> Service X was found running, or the default port(s) for service X were
  open

